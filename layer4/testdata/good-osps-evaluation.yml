evaluations:
  - control-id: "OSPS-BR-06"
    name: "Produce all released software assets with signatures and hashes"
    message: "Security insights required for this assessment, but file not found"
    result: Needs Review
    assessments:
      - requirement-id: "OSPS-BR-06.01"
        description: "Determine if the project publishes SLSA provenance attestations"
        result: Needs Review
        message: "Security insights required for this assessment, but file not found"
        procedures:
          # This show an example from
          # https://github.com/revanite-io/pvtr-github-repo/blob/main/evaluation_plans/osps/build_release/evaluations.go#L174-L178
          # where this support a multistep assessment
          - id: "insight-has-attestation"
            name: "Automated review of project declared attestations"
            description: "Check the security insights file in the repository for SLSA attestations."
            method: Test
            run: true
            message: "Security insights required for this assessment, but file not found"
            result: Needs Review
            steps:
              - github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.HasMadeReleases
              - github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.HasSecurityInsightsFile
              - github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/build_release.insightsHasSlsaAttestation
          - id: "release-has-attestation"
            name: "Manual review of project release artifacts"
            description: "Manually review the project release artifacts to find SLSA attestations."
            method: Observation
            run: false
